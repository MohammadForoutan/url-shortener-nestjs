ARG IMAGE_BUILDER=node:24-bookworm
ARG NODE_ENV=development

FROM ${IMAGE_BUILDER}

WORKDIR /app

ENV NODE_ENV=${NODE_ENV}

# Copy dependency files
COPY package.json pnpm-lock.yaml pnpm-workspace.yaml ./
COPY scripts/ ./scripts/

# Install pnpm and dependencies
RUN npm install -g pnpm && \
    pnpm install

# Copy source files
COPY . .

# Start in development mode with hot-reload
CMD ["pnpm", "run", "start:dev"]
